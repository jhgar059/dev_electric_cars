{% extends "base.html" %}

{% block title %}Mapa de Endpoints - Electric Cars Database{% endblock %}

{% block content %}
<div class="container my-5">
    <h1 class="section-title">Mapa de Endpoints de la API</h1>

    <div class="info-block fade-in">
        <p class="lead">
            Este documento detalla la estructura y propósito de cada endpoint disponible en la API "Electric Cars Database". La API sigue los principios RESTful, permitiendo la interacción con los recursos de autos, cargas y estaciones de carga a través de operaciones CRUD (Crear, Leer, Actualizar, Eliminar) y otras consultas específicas.
        </p>

        <h2 class="h4 text-primary mb-3">Convenciones:</h2>
        <ul>
            <li><code>GET</code>: Recuperar recursos.</li>
            <li><code>POST</code>: Crear nuevos recursos.</li>
            <li><code>PUT</code>: Actualizar un recurso existente (reemplazo completo).</li>
            <li><code>DELETE</code>: Eliminar un recurso (moviéndolo a una tabla de historial).</li>
            <li><code>{id}</code>: Representa el identificador único de un recurso.</li>
            <li><code>Query Parameters</code>: Parámetros opcionales o de filtrado en la URL (ej. <code>?param=value</code>).</li>
        </ul>

        <hr class="my-4">

        <h3 class="h4 text-secondary mb-3"><i class="fas fa-car me-2"></i> Endpoints de Autos Eléctricos (<code>/autos</code>)</h3>
        <table class="table table-bordered table-hover">
            <thead>
                <tr>
                    <th>Método</th>
                    <th>Endpoint</th>
                    <th>Descripción</th>
                    <th>Ejemplo de Respuesta (JSON)</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><code>GET</code></td>
                    <td><code>/api/autos/</code></td>
                    <td>Obtiene una lista paginada de todos los autos eléctricos.</td>
                    <td><pre>[{"id": 1, "marca": "Tesla", "modelo": "Model 3", ...}]</pre></td>
                </tr>
                <tr>
                    <td><code>GET</code></td>
                    <td><code>/api/autos/{id}</code></td>
                    <td>Obtiene un auto eléctrico específico por su ID.</td>
                    <td><pre>{"id": 1, "marca": "Tesla", "modelo": "Model 3", ...}</pre></td>
                </tr>
                <tr>
                    <td><code>GET</code></td>
                    <td><code>/api/autos/search/?modelo={modelo}</code></td>
                    <td>Busca autos eléctricos por su modelo (búsqueda parcial).</td>
                    <td><pre>[{"id": 1, "marca": "Tesla", "modelo": "Model 3", ...}]</pre></td>
                </tr>
                <tr>
                    <td><code>POST</code></td>
                    <td><code>/api/autos/</code></td>
                    <td>Crea un nuevo registro de auto eléctrico.</td>
                    <td><pre>{"id": 4, "marca": "Porsche", "modelo": "Taycan", ...}</pre></td>
                </tr>
                <tr>
                    <td><code>PUT</code></td>
                    <td><code>/api/autos/{id}</code></td>
                    <td>Actualiza completamente un auto eléctrico existente por su ID.</td>
                    <td><pre>{"id": 1, "marca": "Tesla", "modelo": "Model 3 Performance", ...}</pre></td>
                </tr>
                <tr>
                    <td><code>PATCH</code></td>
                    <td><code>/api/autos/{id}</code></td>
                    <td>Actualiza parcialmente un auto eléctrico existente por su ID.</td>
                    <td><pre>{"id": 1, "modelo": "Model 3 Long Range", ...}</pre></td>
                </tr>
                <tr>
                    <td><code>DELETE</code></td>
                    <td><code>/api/autos/{id}</code></td>
                    <td>Elimina un auto eléctrico por su ID, moviéndolo a una tabla de historial.</td>
                    <td><pre>{"message": "Auto eliminado y movido al historial."}</pre></td>
                </tr>
            </tbody>
        </table>

        <h3 class="h4 text-secondary mb-3 mt-5"><i class="fas fa-bolt me-2"></i> Endpoints de Registros de Carga (<code>/cargas</code>)</h3>
        <table class="table table-bordered table-hover">
            <thead>
                <tr>
                    <th>Método</th>
                    <th>Endpoint</th>
                    <th>Descripción</th>
                    <th>Ejemplo de Respuesta (JSON)</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><code>GET</code></td>
                    <td><code>/api/cargas/</code></td>
                    <td>Obtiene una lista paginada de todos los registros de dificultad de carga.</td>
                    <td><pre>[{"id": 1, "modelo_auto": "Tesla Model 3", ...}]</pre></td>
                </tr>
                <tr>
                    <td><code>GET</code></td>
                    <td><code>/api/cargas/{id}</code></td>
                    <td>Obtiene un registro de carga específico por su ID.</td>
                    <td><pre>{"id": 1, "modelo_auto": "Tesla Model 3", ...}</pre></td>
                </tr>
                <tr>
                    <td><code>GET</code></td>
                    <td><code>/api/cargas/search/?modelo_auto={modelo}</code></td>
                    <td>Busca registros de carga por modelo de auto (búsqueda parcial).</td>
                    <td><pre>[{"id": 1, "modelo_auto": "Tesla Model 3", ...}]</pre></td>
                </tr>
                <tr>
                    <td><code>POST</code></td>
                    <td><code>/api/cargas/</code></td>
                    <td>Crea un nuevo registro de dificultad de carga.</td>
                    <td><pre>{"id": 4, "modelo_auto": "Audi e-tron", ...}</pre></td>
                </tr>
                <tr>
                    <td><code>PUT</code></td>
                    <td><code>/api/cargas/{id}</code></td>
                    <td>Actualiza completamente un registro de carga existente por su ID.</td>
                    <td><pre>{"id": 1, "tiempo_carga_horas": 7.5, ...}</pre></td>
                </tr>
                <tr>
                    <td><code>PATCH</code></td>
                    <td><code>/api/cargas/{id}</code></td>
                    <td>Actualiza parcialmente un registro de carga existente por su ID.</td>
                    <td><pre>{"id": 1, "dificultad_carga": "media", ...}</pre></td>
                </tr>
                <tr>
                    <td><code>DELETE</code></td>
                    <td><code>/api/cargas/{id}</code></td>
                    <td>Elimina un registro de carga por su ID, moviéndolo a una tabla de historial.</td>
                    <td><pre>{"message": "Registro de carga eliminado y movido al historial."}</pre></td>
                </tr>
            </tbody>
        </table>

        <h3 class="h4 text-secondary mb-3 mt-5"><i class="fas fa-charging-station me-2"></i> Endpoints de Estaciones de Carga (<code>/estaciones</code>)</h3>
        <table class="table table-bordered table-hover">
            <thead>
                <tr>
                    <th>Método</th>
                    <th>Endpoint</th>
                    <th>Descripción</th>
                    <th>Ejemplo de Respuesta (JSON)</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><code>GET</code></td>
                    <td><code>/api/estaciones/</code></td>
                    <td>Obtiene una lista paginada de todas las estaciones de carga.</td>
                    <td><pre>[{"id": 1, "nombre": "Supercharger Bogotá", ...}]</pre></td>
                </tr>
                <tr>
                    <td><code>GET</code></td>
                    <td><code>/api/estaciones/{id}</code></td>
                    <td>Obtiene una estación de carga específica por su ID.</td>
                    <td><pre>{"id": 1, "nombre": "Supercharger Bogotá", ...}</pre></td>
                </tr>
                <tr>
                    <td><code>GET</code></td>
                    <td><code>/api/estaciones/search/?nombre={nombre}</code></td>
                    <td>Busca estaciones de carga por su nombre (búsqueda parcial).</td>
                    <td><pre>[{"id": 1, "nombre": "Supercharger Bogotá", ...}]</pre></td>
                </tr>
                <tr>
                    <td><code>POST</code></td>
                    <td><code>/api/estaciones/</code></td>
                    <td>Crea una nueva estación de carga.</td>
                    <td><pre>{"id": 4, "nombre": "ChargePoint CC", ...}</pre></td>
                </tr>
                <tr>
                    <td><code>PUT</code></td>
                    <td><code>/api/estaciones/{id}</code></td>
                    <td>Actualiza completamente una estación de carga existente por su ID.</td>
                    <td><pre>{"id": 1, "potencia_kw": 150.0, ...}</pre></td>
                </tr>
                <tr>
                    <td><code>PATCH</code></td>
                    <td><code>/api/estaciones/{id}</code></td>
                    <td>Actualiza parcialmente una estación de carga existente por su ID.</td>
                    <td><pre>{"id": 1, "acceso_publico": false, ...}</pre></td>
                </tr>
                <tr>
                    <td><code>DELETE</code></td>
                    <td><code>/api/estaciones/{id}</code></td>
                    <td>Elimina una estación de carga por su ID, moviéndola a una tabla de historial.</td>
                    <td><pre>{"message": "Estación de carga eliminada y movida al historial."}</pre></td>
                </tr>
            </tbody>
        </table>

        <h3 class="h4 text-secondary mb-3 mt-5"><i class="fas fa-chart-bar me-2"></i> Endpoints de Estadísticas (<code>/api/statistics</code>)</h3>
        <table class="table table-bordered table-hover">
            <thead>
                <tr>
                    <th>Método</th>
                    <th>Endpoint</th>
                    <th>Descripción</th>
                    <th>Ejemplo de Respuesta (JSON)</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><code>GET</code></td>
                    <td><code>/api/statistics/cars_by_brand</code></td>
                    <td>Obtiene el conteo de autos eléctricos agrupados por marca.</td>
                    <td><pre>[{"marca": "Tesla", "count": 2}, {"marca": "Hyundai", "count": 1}]</pre></td>
                </tr>
                <tr>
                    <td><code>GET</code></td>
                    <td><code>/api/statistics/station_power_by_connector_type</code></td>
                    <td>Obtiene la potencia promedio de las estaciones de carga por tipo de conector.</td>
                    <td><pre>[{"tipo_conector": "CCS", "avg_potencia_kw": 75.0}, {"tipo_conector": "Tesla", "avg_potencia_kw": 120.0}]</pre></td>
                </tr>
                <tr>
                    <td><code>GET</code></td>
                    <td><code>/api/statistics/charge_difficulty_distribution</code></td>
                    <td>Obtiene la distribución de la dificultad de carga (baja, media, alta).</td>
                    <td><pre>[{"dificultad": "baja", "count": 3}, {"dificultad": "media", "count": 1}]</pre></td>
                </tr>
            </tbody>
        </table>

        <h3 class="h4 text-secondary mb-3 mt-5"><i class="fas fa-file-alt me-2"></i> Endpoints de Documentación y Vistas HTML</h3>
        <table class="table table-bordered table-hover">
            <thead>
                <tr>
                    <th>Método</th>
                    <th>Endpoint</th>
                    <th>Descripción</th>
                    <th>Tipo de Respuesta</th>
                </tr>
            </thead>
            <tbody>
                <tr><td><code>GET</code></td><td><code>/</code></td><td>Página de inicio de la aplicación.</td><td>HTML</td></tr>
                <tr><td><code>GET</code></td><td><code>/cars</code></td><td>Página para gestionar autos eléctricos (CRUD e interfaz).</td><td>HTML</td></tr>
                <tr><td><code>GET</code></td><td><code>/charges</code></td><td>Página para gestionar registros de dificultad de carga (CRUD e interfaz).</td><td>HTML</td></tr>
                <tr><td><code>GET</code></td><td><code>/stations</code></td><td>Página para gestionar estaciones de carga (CRUD e interfaz).</td><td>HTML</td></tr>
                <tr><td><code>GET</code></td><td><code>/project_objective</code></td><td>Página que explica el objetivo del proyecto.</td><td>HTML</td></tr>
                <tr><td><code>GET</code></td><td><code>/mockups_wireframes</code></td><td>Página con los mockups y wireframes de la interfaz.</td><td>HTML</td></tr>
                <tr><td><code>GET</code></td><td><code>/endpoint_map</code></td><td>Este mismo mapa de endpoints.</td><td>HTML</td></tr>
                <tr><td><code>GET</code></td><td><code>/statistics_page</code></td><td>Página para mostrar estadísticas y gráficos.</td><td>HTML</td></tr>
            </tbody>
        </table>

        <small class="d-block text-muted mt-4">Nota: Los ejemplos de respuesta son representativos y pueden variar ligeramente.</small>
    </div>
</div>
{% endblock %}